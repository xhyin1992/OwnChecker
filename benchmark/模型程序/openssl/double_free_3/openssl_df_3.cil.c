/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is true */

#line 216 "/usr/lib/gcc/x86_64-linux-gnu/5/include/stddef.h"
typedef unsigned long size_t;
#line 353 "../openssl.h"
struct x509_st;
#line 353 "../openssl.h"
typedef struct x509_st X509;
#line 380
struct ssl_st;
#line 380 "../openssl.h"
typedef struct ssl_st SSL;
#line 11 "openssl_df_3.c"
struct __anonstruct_PACKET_27 {
   unsigned char const   *curr ;
   size_t remaining ;
};
#line 11 "openssl_df_3.c"
typedef struct __anonstruct_PACKET_27 PACKET;
#line 18 "openssl_df_3.c"
typedef void WPACKET;
#line 20 "openssl_df_3.c"
struct __anonstruct_ext_28 {
   unsigned char *tls13_cookie ;
   size_t tls13_cookie_len ;
};
#line 20 "openssl_df_3.c"
struct ssl_st {
   struct __anonstruct_ext_28 ext ;
};
#line 466 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) malloc)(size_t __size )  __attribute__((__malloc__)) ;
#line 483
extern  __attribute__((__nothrow__)) void ( __attribute__((__leaf__)) free)(void *__ptr ) ;
#line 27 "openssl_df_3.c"
void SSL_free(SSL *s ) 
{ 


  {
#line 29
  if ((unsigned long )s == (unsigned long )((void *)0)) {
#line 30
    return;
  }
#line 32
  free((void *)s->ext.tls13_cookie);
#line 33
  free((void *)s);
#line 34
  return;
}
}
#line 53
extern int ( /* missing proto */  PACKET_remaining)() ;
#line 58
extern int ( /* missing proto */  strdup)() ;
#line 45 "openssl_df_3.c"
int PACKET_memdup(PACKET const   *pkt , unsigned char **data , size_t *len ) 
{ 
  size_t length ;
  int tmp ;
  int tmp___0 ;

  {
#line 49
  free((void *)*data);
#line 50
  *data = (unsigned char *)((void *)0);
#line 51
  *len = (size_t )0;
#line 53
  tmp = PACKET_remaining(pkt);
#line 53
  length = (size_t )tmp;
#line 55
  if (length == 0UL) {
#line 56
    return (1);
  }
#line 58
  tmp___0 = strdup(pkt->curr);
#line 58
  *data = (unsigned char *)tmp___0;
#line 59
  if ((unsigned long )*data == (unsigned long )((void *)0)) {
#line 60
    return (0);
  }
#line 62
  *len = length;
#line 63
  return (1);
}
}
#line 71
extern int ( /* missing proto */  PACKET_as_length_prefixed_2)() ;
#line 66 "openssl_df_3.c"
int tls_parse_stoc_cookie(SSL *s , PACKET *pkt , unsigned int context , X509 *x ,
                          size_t chainidx , int *al ) 
{ 
  PACKET cookie ;
  int tmp ;
  int tmp___0 ;

  {
#line 71
  tmp = PACKET_as_length_prefixed_2(pkt, & cookie);
#line 71
  if (tmp) {
#line 71
    tmp___0 = PACKET_memdup((PACKET const   *)(& cookie), & s->ext.tls13_cookie, & s->ext.tls13_cookie_len);
#line 71
    if (! tmp___0) {
#line 74
      return (0);
    }
  } else {
#line 74
    return (0);
  }
#line 77
  return (1);
}
}
#line 89
extern int ( /* missing proto */  WPACKET_put_bytes_u16)() ;
#line 89
extern int ( /* missing proto */  WPACKET_start_sub_packet_u16)() ;
#line 89
extern int ( /* missing proto */  WPACKET_sub_memcpy_u16)() ;
#line 89
extern int ( /* missing proto */  WPACKET_close)() ;
#line 80 "openssl_df_3.c"
int tls_construct_ctos_cookie(SSL *s , WPACKET *pkt , unsigned int context , X509 *x ,
                              size_t chainidx , int *al ) 
{ 
  int ret ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;

  {
#line 83
  ret = 0;
#line 86
  if (s->ext.tls13_cookie_len == 0UL) {
#line 87
    return (1);
  }
#line 89
  tmp = WPACKET_put_bytes_u16(pkt, 0);
#line 89
  if (tmp) {
#line 89
    tmp___0 = WPACKET_start_sub_packet_u16(pkt);
#line 89
    if (tmp___0) {
#line 89
      tmp___1 = WPACKET_sub_memcpy_u16(pkt, s->ext.tls13_cookie, s->ext.tls13_cookie_len);
#line 89
      if (tmp___1) {
#line 89
        tmp___2 = WPACKET_close(pkt);
#line 89
        if (! tmp___2) {
#line 95
          goto end;
        }
      } else {
#line 95
        goto end;
      }
    } else {
#line 95
      goto end;
    }
  } else {
#line 95
    goto end;
  }
#line 98
  ret = 1;
  end: 
#line 100
  free((void *)s->ext.tls13_cookie);
#line 101
  s->ext.tls13_cookie_len = (size_t )0;
#line 103
  return (ret);
}
}
#line 106 "openssl_df_3.c"
int main(void) 
{ 
  PACKET pkt ;
  SSL *s ;
  void *tmp ;

  {
#line 109
  tmp = malloc(sizeof(SSL ));
#line 109
  s = (SSL *)tmp;
#line 110
  s->ext.tls13_cookie = (unsigned char *)((void *)0);
#line 111
  s->ext.tls13_cookie_len = (size_t )0;
#line 113
  pkt.curr = (unsigned char const   *)"PACKET";
#line 115
  tls_parse_stoc_cookie(s, & pkt, 0U, (X509 *)((void *)0), (size_t )0, (int *)((void *)0));
#line 116
  tls_construct_ctos_cookie(s, (void *)0, 0U, (X509 *)((void *)0), (size_t )0, (int *)((void *)0));
#line 118
  SSL_free(s);
#line 119
  return (0);
}
}
