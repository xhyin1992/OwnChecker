/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is true */

#line 216 "/usr/lib/gcc/x86_64-linux-gnu/5/include/stddef.h"
typedef unsigned long size_t;
#line 131 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off_t;
#line 132 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off64_t;
#line 139 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __time_t;
#line 172 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __ssize_t;
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 44
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 144 "/usr/include/libio.h"
struct _IO_FILE;
#line 150 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 156 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 241 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 102 "/usr/include/stdio.h"
typedef __ssize_t ssize_t;
#line 75 "/usr/include/time.h"
typedef __time_t time_t;
#line 203 "/usr/include/x86_64-linux-gnu/sys/types.h"
typedef unsigned long u_int64_t;
#line 54 "/usr/include/x86_64-linux-gnu/sys/select.h"
typedef long __fd_mask;
#line 64 "/usr/include/x86_64-linux-gnu/sys/select.h"
struct __anonstruct_fd_set_14 {
   __fd_mask __fds_bits[1024 / (8 * (int )sizeof(__fd_mask ))] ;
};
#line 64 "/usr/include/x86_64-linux-gnu/sys/select.h"
typedef struct __anonstruct_fd_set_14 fd_set;
#line 196 "../stdio.h"
typedef unsigned int u_int___0;
#line 200 "../stdio.h"
typedef int int32_t___0;
#line 203 "../stdio.h"
typedef unsigned int u_int32_t___0;
#line 207 "../stdio.h"
typedef unsigned char u_char___0;
#line 214 "../stdio.h"
typedef int sig_atomic_t;
#line 351 "../openssh.h"
struct sshbuf {
   u_char___0 *d ;
   u_char___0 const   *cd ;
   size_t off ;
   size_t size ;
   size_t max_size ;
   size_t alloc ;
   int readonly ;
   int dont_free ;
   u_int___0 refcount ;
   struct sshbuf *parent ;
};
#line 364 "../openssh.h"
typedef u_int___0 BN_ULONG;
#line 372 "../openssh.h"
struct bignum_st {
   BN_ULONG *d ;
   int top ;
   int dmax ;
   int neg ;
   int flags ;
};
#line 390 "../openssh.h"
typedef struct bignum_st BIGNUM;
#line 391 "../openssh.h"
struct rsa_st {
   int pad ;
   int32_t___0 version ;
   void const   *meth ;
   void *engine ;
   BIGNUM *n ;
   BIGNUM *e ;
   BIGNUM *d ;
   BIGNUM *p ;
   BIGNUM *q ;
   BIGNUM *dmp1 ;
   BIGNUM *dmq1 ;
   BIGNUM *iqmp ;
   void *pss ;
   int ex_data ;
   int references ;
   int flags ;
   void *_method_mod_n ;
   void *_method_mod_p ;
   void *_method_mod_q ;
   char *bignum_data ;
   void *blinding ;
   void *mt_blinding ;
   void *lock ;
};
#line 391 "../openssh.h"
typedef struct rsa_st RSA;
#line 434 "../openssh.h"
struct dsa_st {
   int pad ;
   int32_t___0 version ;
   BIGNUM *p ;
   BIGNUM *q ;
   BIGNUM *g ;
   BIGNUM *pub_key ;
   BIGNUM *priv_key ;
   int flags ;
};
#line 434 "../openssh.h"
typedef struct dsa_st DSA;
#line 615 "../openssh.h"
struct newkeys {
   char *enc ;
   char *mac ;
   char *comp ;
};
#line 626
struct sshkey;
#line 626 "../openssh.h"
struct sshkey_cert {
   struct sshbuf *certblob ;
   u_int___0 type ;
   u_int64_t serial ;
   char *key_id ;
   u_int___0 nprincipals ;
   char **principals ;
   u_int64_t valid_after ;
   u_int64_t valid_before ;
   struct sshbuf *critical ;
   struct sshbuf *extensions ;
   struct sshkey *signature_key ;
};
#line 640 "../openssh.h"
struct sshkey {
   int type ;
   int flags ;
   RSA *rsa ;
   DSA *dsa ;
   int ecdsa_nid ;
   void *ecdsa ;
   u_char___0 *ed25519_sk ;
   u_char___0 *ed25519_pk ;
   struct sshkey_cert *cert ;
};
#line 652
struct ssh;
#line 652 "../openssh.h"
struct kex {
   u_char___0 *session_id ;
   size_t session_id_len ;
   struct newkeys *newkeys[2] ;
   u_int___0 we_need ;
   u_int___0 dh_need ;
   int server ;
   char *name ;
   char *hostkey_alg ;
   int hostkey_type ;
   int hostkey_nid ;
   u_int___0 kex_type ;
   int rsa_sha2 ;
   int ext_info_c ;
   struct sshbuf *my ;
   struct sshbuf *peer ;
   sig_atomic_t done ;
   u_int___0 flags ;
   int hash_alg ;
   int ec_nid ;
   char *client_version_string ;
   char *server_version_string ;
   char *failed_choice ;
   int (*verify_host_key)(struct sshkey * , struct ssh * ) ;
   struct sshkey *(*load_host_public_key)(int  , int  , struct ssh * ) ;
   struct sshkey *(*load_host_private_key)(int  , int  , struct ssh * ) ;
   int (*host_key_index)(struct sshkey * , int  , struct ssh * ) ;
   int (*sign)(struct sshkey * , struct sshkey * , u_char___0 ** , size_t * , u_char___0 const   * ,
               size_t  , char const   * , u_int___0  ) ;
   int (*kex[9])(struct ssh * ) ;
   void *dh ;
   u_int___0 min ;
   u_int___0 max ;
   u_int___0 nbits ;
   void *ec_client_key ;
   void const   *ec_group ;
   u_char___0 c25519_client_key[32] ;
   u_char___0 c25519_client_pubkey[32] ;
};
#line 1054 "../openssh.h"
struct packet_state {
   u_int32_t___0 seqnr ;
   u_int32_t___0 packets ;
   u_int64_t blocks ;
   u_int64_t bytes ;
};
#line 1061 "../openssh.h"
struct __anonstruct_next_31 {
   struct packet *tqe_next ;
   struct packet **tqe_prev ;
};
#line 1061 "../openssh.h"
struct packet {
   struct __anonstruct_next_31 next ;
   u_char___0 type ;
   struct sshbuf *payload ;
};
#line 1067 "../openssh.h"
typedef int ssh_packet_hook_fn(struct ssh * , struct sshbuf * , u_char___0 * , void * );
#line 1070 "../openssh.h"
typedef int z_stream;
#line 1073
struct sshcipher_ctx;
#line 1073
struct sshmac;
#line 1073 "../openssh.h"
struct __anonstruct_outgoing_32 {
   struct packet *tqh_first ;
   struct packet **tqh_last ;
};
#line 1073 "../openssh.h"
struct session_state {
   int connection_in ;
   int connection_out ;
   u_int___0 remote_protocol_flags ;
   struct sshcipher_ctx *receive_context ;
   struct sshcipher_ctx *send_context ;
   struct sshbuf *input ;
   struct sshbuf *output ;
   struct sshbuf *outgoing_packet ;
   struct sshbuf *incoming_packet ;
   struct sshbuf *compression_buffer ;
   z_stream compression_in_stream ;
   z_stream compression_out_stream ;
   int compression_in_started ;
   int compression_out_started ;
   int compression_in_failures ;
   int compression_out_failures ;
   int packet_compression ;
   u_int___0 max_packet_size ;
   int initialized ;
   int interactive_mode ;
   int server_side ;
   int after_authentication ;
   int keep_alive_timeouts ;
   int packet_timeout_ms ;
   struct newkeys *newkeys[2] ;
   struct packet_state p_read ;
   struct packet_state p_send ;
   u_int64_t max_blocks_in ;
   u_int64_t max_blocks_out ;
   u_int64_t rekey_limit ;
   u_int32_t___0 rekey_interval ;
   time_t rekey_time ;
   u_char___0 ssh1_key[32] ;
   u_int___0 ssh1_keylen ;
   u_char___0 extra_pad ;
   u_int___0 packet_discard ;
   size_t packet_discard_mac_already ;
   struct sshmac *packet_discard_mac ;
   u_int___0 packlen ;
   int rekeying ;
   int mux ;
   int set_interactive_called ;
   int set_maxsize_called ;
   int cipher_warning_done ;
   char *deattack ;
   ssh_packet_hook_fn *hook_in ;
   void *hook_in_ctx ;
   struct __anonstruct_outgoing_32 outgoing ;
};
#line 157 "openssh_uaf_1.c"
struct channel_confirms {

};
#line 158 "openssh_uaf_1.c"
struct channel_connect {

};
#line 160 "openssh_uaf_1.c"
typedef void channel_open_fn(struct ssh * , int  , int  , void * );
#line 161 "openssh_uaf_1.c"
typedef void channel_callback_fn(struct ssh * , int  , void * );
#line 162
struct Channel;
#line 162 "openssh_uaf_1.c"
typedef int channel_infilter_fn(struct ssh * , struct Channel * , char * , int  );
#line 163 "openssh_uaf_1.c"
typedef void channel_filter_cleanup_fn(struct ssh * , int  , void * );
#line 164 "openssh_uaf_1.c"
typedef u_char___0 *channel_outfilter_fn(struct ssh * , struct Channel * , u_char___0 ** ,
                                         size_t * );
#line 166 "openssh_uaf_1.c"
typedef int mux_callback_fn(struct ssh * , struct Channel * );
#line 168 "openssh_uaf_1.c"
struct Channel {
   int type ;
   int self ;
   int have_remote_id ;
   u_int___0 istate ;
   u_int___0 ostate ;
   int flags ;
   int rfd ;
   int wfd ;
   int efd ;
   int sock ;
   int ctl_chan ;
   int isatty ;
   int client_tty ;
   int force_drain ;
   time_t notbefore ;
   int delayed ;
   struct sshbuf *input ;
   struct sshbuf *output ;
   struct sshbuf *extended ;
   char *path ;
   int listening_port ;
   char *listening_addr ;
   int host_port ;
   char *remote_name ;
   u_int___0 remote_window ;
   u_int___0 remote_maxpacket ;
   u_int___0 local_window ;
   u_int___0 local_window_max ;
   u_int___0 local_consumed ;
   u_int___0 local_maxpacket ;
   int extended_usage ;
   int single_connection ;
   char *ctype ;
   channel_open_fn *open_confirm ;
   void *open_confirm_ctx ;
   channel_callback_fn *detach_user ;
   int detach_close ;
   struct channel_confirms status_confirms ;
   channel_infilter_fn *input_filter ;
   channel_outfilter_fn *output_filter ;
   void *filter_ctx ;
   channel_filter_cleanup_fn *filter_cleanup ;
   int datagram ;
   struct channel_connect connect_ctx ;
   mux_callback_fn *mux_rcb ;
   void *mux_ctx ;
   int mux_pause ;
   int mux_downstream_id ;
};
#line 244 "openssh_uaf_1.c"
typedef struct Channel Channel;
#line 246 "openssh_uaf_1.c"
struct __anonstruct_ForwardPermission_35 {
   char *host_to_connect ;
   int port_to_connect ;
   char *listen_host ;
   char *listen_path ;
   int listen_port ;
   Channel *downstream ;
};
#line 246 "openssh_uaf_1.c"
typedef struct __anonstruct_ForwardPermission_35 ForwardPermission;
#line 255 "openssh_uaf_1.c"
typedef void chan_fn(struct ssh * , Channel *c , fd_set *readset , fd_set *writeset );
#line 259 "openssh_uaf_1.c"
struct ssh_channels {
   Channel **channels ;
   u_int___0 channels_alloc ;
   int channel_max_fd ;
   chan_fn **channel_pre ;
   chan_fn **channel_post ;
   ForwardPermission *permitted_opens ;
   ForwardPermission *permitted_adm_opens ;
   u_int___0 num_permitted_opens ;
   u_int___0 num_adm_permitted_opens ;
   int all_opens_permitted ;
   char *x11_saved_display ;
   char *x11_saved_proto ;
   char *x11_saved_data ;
   u_int___0 x11_saved_data_len ;
   u_int___0 x11_refuse_time ;
   u_char___0 *x11_fake_data ;
   u_int___0 x11_fake_data_len ;
   int IPv4or6 ;
};
#line 352 "openssh_uaf_1.c"
typedef int dispatch_fn(int  , u_int32_t___0  , struct ssh * );
#line 354
struct key_entry;
#line 354 "openssh_uaf_1.c"
struct __anonstruct_private_keys_37 {
   struct key_entry *tqh_first ;
   struct key_entry **tqh_last ;
};
#line 354 "openssh_uaf_1.c"
struct __anonstruct_public_keys_38 {
   struct key_entry *tqh_first ;
   struct key_entry **tqh_last ;
};
#line 354 "openssh_uaf_1.c"
struct ssh {
   struct session_state *state ;
   struct kex *kex ;
   char *remote_ipaddr ;
   int remote_port ;
   char *local_ipaddr ;
   int local_port ;
   char *log_preamble ;
   dispatch_fn *dispatch[255] ;
   int dispatch_skip_packets ;
   int compat ;
   struct __anonstruct_private_keys_37 private_keys ;
   struct __anonstruct_public_keys_38 public_keys ;
   void *authctxt ;
   struct ssh_channels *chanctxt ;
   void *app_data ;
};
#line 579
struct channel_confirm;
#line 169 "/usr/include/stdio.h"
extern struct _IO_FILE *stdout ;
#line 170
extern struct _IO_FILE *stderr ;
#line 362
extern int printf(char const   * __restrict  __format  , ...) ;
#line 858
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) fileno)(FILE *__stream ) ;
#line 468 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__leaf__)) calloc)(size_t __nmemb ,
                                                                               size_t __size )  __attribute__((__malloc__)) ;
#line 483
extern  __attribute__((__nothrow__)) void ( __attribute__((__leaf__)) free)(void *__ptr ) ;
#line 543
extern  __attribute__((__nothrow__, __noreturn__)) void ( __attribute__((__leaf__)) exit)(int __status ) ;
#line 60 "openssh_uaf_1.c"
static int volatile   received_window_change_signal  =    (sig_atomic_t volatile   )0;
#line 70 "openssh_uaf_1.c"
sig_atomic_t volatile   quit_pending  ;
#line 81 "openssh_uaf_1.c"
int session_ident  =    -1;
#line 342
extern ssize_t *vwrite(int  , void * , size_t  ) ;
#line 395
extern int ( /* missing proto */  explicit_bzero)() ;
#line 392 "openssh_uaf_1.c"
void sshbuf_init(struct sshbuf *ret ) 
{ 
  u_char___0 const   *tmp ;
  u_char___0 *tmp___0 ;
  void *tmp___1 ;

  {
#line 395
  explicit_bzero(ret, sizeof(*ret));
#line 396
  ret->alloc = (size_t )256;
#line 397
  ret->max_size = (size_t )134217728;
#line 398
  ret->readonly = 0;
#line 399
  ret->dont_free = 1;
#line 400
  ret->refcount = (u_int___0 )1;
#line 401
  tmp___1 = calloc((size_t )1, ret->alloc);
#line 401
  tmp___0 = (u_char___0 *)tmp___1;
#line 401
  ret->d = tmp___0;
#line 401
  tmp = (u_char___0 const   *)tmp___0;
#line 401
  ret->cd = tmp;
#line 401
  if ((unsigned long )tmp == (unsigned long )((void *)0)) {
#line 402
    ret->alloc = (size_t )0;
  }
#line 403
  return;
}
}
#line 418
extern int ( /* missing proto */  sshbuf_check_sanity)() ;
#line 405 "openssh_uaf_1.c"
void sshbuf_free(struct sshbuf *buf ) 
{ 
  int dont_free ;
  int tmp ;

  {
#line 408
  dont_free = 0;
#line 410
  if ((unsigned long )buf == (unsigned long )((void *)0)) {
#line 411
    return;
  }
#line 418
  tmp = sshbuf_check_sanity(buf);
#line 418
  if (tmp != 0) {
#line 419
    return;
  }
#line 424
  sshbuf_free(buf->parent);
#line 425
  buf->parent = (struct sshbuf *)((void *)0);
#line 431
  (buf->refcount) --;
#line 432
  if (buf->refcount > 0U) {
#line 433
    return;
  }
#line 434
  dont_free = buf->dont_free;
#line 435
  if (! buf->readonly) {
#line 436
    explicit_bzero(buf->d, buf->alloc);
#line 437
    free((void *)buf->d);
  }
#line 439
  explicit_bzero(buf, sizeof(*buf));
#line 440
  if (! dont_free) {
#line 441
    free((void *)buf);
  }
#line 442
  return;
}
}
#line 457
extern int ( /* missing proto */  recallocarray)() ;
#line 444 "openssh_uaf_1.c"
void sshbuf_reset(struct sshbuf *buf ) 
{ 
  u_char___0 *d ;
  size_t tmp ;
  u_char___0 *tmp___0 ;
  int tmp___1 ;

  {
#line 449
  if (buf->readonly) {
#line 451
    buf->off = buf->size;
#line 452
    return;
  } else
#line 449
  if (buf->refcount > 1U) {
#line 451
    buf->off = buf->size;
#line 452
    return;
  }
#line 454
  sshbuf_check_sanity(buf);
#line 455
  tmp = (size_t )0;
#line 455
  buf->size = tmp;
#line 455
  buf->off = tmp;
#line 456
  if (buf->alloc != 256UL) {
#line 457
    tmp___1 = recallocarray(buf->d, buf->alloc, 256, 1);
#line 457
    d = (u_char___0 *)tmp___1;
#line 457
    if ((unsigned long )d != (unsigned long )((void *)0)) {
#line 459
      tmp___0 = d;
#line 459
      buf->d = tmp___0;
#line 459
      buf->cd = (u_char___0 const   *)tmp___0;
#line 460
      buf->alloc = (size_t )256;
    }
  }
#line 463
  explicit_bzero(buf->d, 256);
#line 464
  return;
}
}
#line 471
extern int ( /* missing proto */  atomicio)() ;
#line 471
extern int ( /* missing proto */  sshbuf_len)() ;
#line 471
extern int ( /* missing proto */  sshbuf_mutable_ptr)() ;
#line 466 "openssh_uaf_1.c"
static void client_suspend_self(struct sshbuf *bin , struct sshbuf *bout , struct sshbuf *berr ) 
{ 
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;

  {
#line 470
  tmp___2 = sshbuf_len(bout);
#line 470
  if ((u_int___0 )tmp___2 > 0U) {
#line 471
    tmp = sshbuf_len(bout);
#line 471
    tmp___0 = sshbuf_mutable_ptr(bout);
#line 471
    tmp___1 = fileno(stdout);
#line 471
    atomicio(& vwrite, tmp___1, tmp___0, (u_int___0 )tmp);
  }
#line 473
  tmp___6 = sshbuf_len(berr);
#line 473
  if ((u_int___0 )tmp___6 > 0U) {
#line 474
    tmp___3 = sshbuf_len(berr);
#line 474
    tmp___4 = sshbuf_mutable_ptr(berr);
#line 474
    tmp___5 = fileno(stderr);
#line 474
    atomicio(& vwrite, tmp___5, tmp___4, (u_int___0 )tmp___3);
  }
#line 482
  sshbuf_free(bin);
#line 483
  sshbuf_free(bout);
#line 484
  sshbuf_free(berr);
#line 488
  received_window_change_signal = (int volatile   )1;
#line 492
  sshbuf_init(bin);
#line 493
  sshbuf_init(bout);
#line 494
  sshbuf_init(berr);
#line 495
  return;
}
}
#line 526
extern int ( /* missing proto */  xrecallocarray)() ;
#line 529
extern int ( /* missing proto */  debug2)() ;
#line 533
extern int ( /* missing proto */  sshbuf_new)() ;
#line 539
extern int ( /* missing proto */  channel_register_fds)() ;
#line 546
extern int ( /* missing proto */  strdup)() ;
#line 549
extern int ( /* missing proto */  debug)() ;
#line 501 "openssh_uaf_1.c"
Channel *channel_new(struct ssh *ssh , char *ctype , int type , int rfd , int wfd ,
                     int efd , u_int___0 window , u_int___0 maxpack , int extusage ,
                     char *remote_name , int nonblock ) 
{ 
  struct ssh_channels *sc ;
  u_int___0 i ;
  u_int___0 found ;
  Channel *c ;
  int tmp ;
  Channel *tmp___0 ;
  void *tmp___1 ;
  struct sshbuf *tmp___2 ;
  int tmp___3 ;
  struct sshbuf *tmp___4 ;
  int tmp___5 ;
  struct sshbuf *tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;

  {
#line 505
  sc = ssh->chanctxt;
#line 510
  i = (u_int___0 )0;
#line 510
  while (i < sc->channels_alloc) {
#line 511
    if ((unsigned long )*(sc->channels + i) == (unsigned long )((void *)0)) {
#line 513
      found = i;
#line 514
      break;
    }
#line 510
    i ++;
  }
#line 517
  if (i >= sc->channels_alloc) {
#line 522
    found = sc->channels_alloc;
#line 523
    if (sc->channels_alloc > 16384U) {
#line 524
      printf((char const   * __restrict  )"%s: internal error: channels_alloc too big",
             "channel_new");
#line 524
      exit(1);
    }
#line 526
    tmp = xrecallocarray(sc->channels, sc->channels_alloc, sc->channels_alloc + 10U,
                         sizeof(*(sc->channels)));
#line 526
    sc->channels = (Channel **)tmp;
#line 528
    sc->channels_alloc += 10U;
#line 529
    debug2("channel: expanding %d", sc->channels_alloc);
  }
#line 532
  tmp___1 = calloc((size_t )1, sizeof(Channel ));
#line 532
  tmp___0 = (Channel *)tmp___1;
#line 532
  *(sc->channels + found) = tmp___0;
#line 532
  c = tmp___0;
#line 533
  tmp___3 = sshbuf_new();
#line 533
  tmp___2 = (struct sshbuf *)tmp___3;
#line 533
  c->input = tmp___2;
#line 533
  if ((unsigned long )tmp___2 == (unsigned long )((void *)0)) {
#line 536
    printf((char const   * __restrict  )"%s: sshbuf_new failed", "channel_new");
#line 536
    exit(1);
  } else {
#line 533
    tmp___5 = sshbuf_new();
#line 533
    tmp___4 = (struct sshbuf *)tmp___5;
#line 533
    c->output = tmp___4;
#line 533
    if ((unsigned long )tmp___4 == (unsigned long )((void *)0)) {
#line 536
      printf((char const   * __restrict  )"%s: sshbuf_new failed", "channel_new");
#line 536
      exit(1);
    } else {
#line 533
      tmp___7 = sshbuf_new();
#line 533
      tmp___6 = (struct sshbuf *)tmp___7;
#line 533
      c->extended = tmp___6;
#line 533
      if ((unsigned long )tmp___6 == (unsigned long )((void *)0)) {
#line 536
        printf((char const   * __restrict  )"%s: sshbuf_new failed", "channel_new");
#line 536
        exit(1);
      }
    }
  }
#line 537
  c->ostate = (u_int___0 )0;
#line 538
  c->istate = (u_int___0 )0;
#line 539
  channel_register_fds(ssh, c, rfd, wfd, efd, extusage, nonblock, 0);
#line 540
  c->self = (int )found;
#line 541
  c->type = type;
#line 542
  c->ctype = ctype;
#line 543
  c->local_window = window;
#line 544
  c->local_window_max = window;
#line 545
  c->local_maxpacket = maxpack;
#line 546
  tmp___8 = strdup(remote_name);
#line 546
  c->remote_name = (char *)tmp___8;
#line 547
  c->ctl_chan = -1;
#line 548
  c->delayed = 1;
#line 549
  debug("channel %d: new [%s]", found, remote_name);
#line 550
  return (c);
}
}
#line 566
extern int ( /* missing proto */  channel_handler_init)() ;
#line 553 "openssh_uaf_1.c"
void channel_init_channels(struct ssh *ssh ) 
{ 
  struct ssh_channels *sc ;
  void *tmp ;
  chan_fn **tmp___0 ;
  void *tmp___1 ;
  chan_fn **tmp___2 ;
  void *tmp___3 ;
  void *tmp___4 ;

  {
#line 558
  tmp = calloc((size_t )1, sizeof(*sc));
#line 558
  sc = (struct ssh_channels *)tmp;
#line 558
  if ((unsigned long )sc == (unsigned long )((void *)0)) {
#line 563
    printf((char const   * __restrict  )"%s: allocation failed", "channel_init_channels");
#line 563
    exit(1);
  } else {
#line 558
    tmp___1 = calloc((size_t )21, sizeof(*(sc->channel_pre)));
#line 558
    tmp___0 = (chan_fn **)tmp___1;
#line 558
    sc->channel_pre = tmp___0;
#line 558
    if ((unsigned long )tmp___0 == (unsigned long )((void *)0)) {
#line 563
      printf((char const   * __restrict  )"%s: allocation failed", "channel_init_channels");
#line 563
      exit(1);
    } else {
#line 558
      tmp___3 = calloc((size_t )21, sizeof(*(sc->channel_post)));
#line 558
      tmp___2 = (chan_fn **)tmp___3;
#line 558
      sc->channel_post = tmp___2;
#line 558
      if ((unsigned long )tmp___2 == (unsigned long )((void *)0)) {
#line 563
        printf((char const   * __restrict  )"%s: allocation failed", "channel_init_channels");
#line 563
        exit(1);
      }
    }
  }
#line 564
  sc->channels_alloc = (u_int___0 )10;
#line 565
  tmp___4 = calloc((size_t )sc->channels_alloc, sizeof(*(sc->channels)));
#line 565
  sc->channels = (Channel **)tmp___4;
#line 566
  channel_handler_init(sc);
#line 568
  ssh->chanctxt = sc;
#line 569
  return;
}
}
#line 599
extern int ( /* missing proto */  mux_remove_remote_forwardings)() ;
#line 601
extern int ( /* missing proto */  channel_open_message)() ;
#line 602
extern int ( /* missing proto */  debug3)() ;
#line 605
extern int ( /* missing proto */  channel_close_fds)() ;
#line 617
extern int ( /* missing proto */  bzero)() ;
#line 572 "openssh_uaf_1.c"
void channel_free(struct ssh *ssh , Channel *c ) 
{ 
  struct ssh_channels *sc ;
  char *s ;
  u_int___0 i ;
  u_int___0 n ;
  Channel *other ;
  char const   *tmp ;
  int tmp___0 ;
  struct sshbuf *tmp___1 ;
  struct sshbuf *tmp___2 ;

  {
#line 575
  sc = ssh->chanctxt;
#line 581
  n = (u_int___0 )0;
#line 581
  i = (u_int___0 )0;
#line 581
  while (i < sc->channels_alloc) {
#line 582
    other = *(sc->channels + i);
#line 582
    if ((unsigned long )other == (unsigned long )((void *)0)) {
#line 583
      goto __Cont;
    }
#line 584
    n ++;
#line 586
    if (c->type == 16) {
#line 586
      if (other->type == 20) {
#line 586
        if ((unsigned long )other->mux_ctx == (unsigned long )c) {
#line 589
          other->mux_ctx = (void *)0;
#line 590
          other->type = 4;
#line 591
          other->istate = (u_int___0 )3;
#line 592
          other->ostate = (u_int___0 )3;
        }
      }
    }
    __Cont: /* CIL Label */ 
#line 581
    i ++;
  }
#line 595
  if (c->remote_name) {
#line 595
    tmp = (char const   *)c->remote_name;
  } else {
#line 595
    tmp = "???";
  }
#line 595
  debug("channel %d: free: %s, nchannels %u", c->self, tmp, n);
#line 598
  if (c->type == 16) {
#line 599
    mux_remove_remote_forwardings(ssh, c);
  }
#line 601
  tmp___0 = channel_open_message(ssh);
#line 601
  s = (char *)tmp___0;
#line 602
  debug3("channel %d: status: %s", c->self, s);
#line 603
  free((void *)s);
#line 605
  channel_close_fds(ssh, c);
#line 606
  sshbuf_free(c->input);
#line 607
  sshbuf_free(c->output);
#line 608
  sshbuf_free(c->extended);
#line 609
  tmp___2 = (struct sshbuf *)((void *)0);
#line 609
  c->extended = tmp___2;
#line 609
  tmp___1 = tmp___2;
#line 609
  c->output = tmp___1;
#line 609
  c->input = tmp___1;
#line 610
  free((void *)c->remote_name);
#line 611
  c->remote_name = (char *)((void *)0);
#line 612
  free((void *)c->path);
#line 613
  c->path = (char *)((void *)0);
#line 614
  free((void *)c->listening_addr);
#line 615
  c->listening_addr = (char *)((void *)0);
#line 616
  *(sc->channels + c->self) = (Channel *)((void *)0);
#line 617
  bzero(c, sizeof(*c));
#line 618
  free((void *)c);
#line 619
  return;
}
}
#line 621 "openssh_uaf_1.c"
void channel_free_all(struct ssh *ssh ) 
{ 
  u_int___0 i ;

  {
#line 626
  i = (u_int___0 )0;
#line 626
  while (i < (ssh->chanctxt)->channels_alloc) {
#line 627
    if ((unsigned long )*((ssh->chanctxt)->channels + i) != (unsigned long )((void *)0)) {
#line 628
      channel_free(ssh, *((ssh->chanctxt)->channels + i));
    }
#line 626
    i ++;
  }
#line 629
  return;
}
}
#line 632 "openssh_uaf_1.c"
int main(int argc , char **argv ) 
{ 
  struct ssh ssh ;
  Channel *c ;
  int in ;
  int out ;
  int i ;

  {
#line 637
  channel_init_channels(& ssh);
#line 638
  i = 1;
#line 638
  while (i < argc) {
#line 639
    c = channel_new(& ssh, (char *)"stdio-forward", 3, in, out, -1, (u_int___0 )2097152,
                    (u_int___0 )32768, 0, (char *)"stdio-forward", 0);
#line 638
    i ++;
  }
#line 643
  client_suspend_self(c->input, c->output, c->extended);
#line 644
  channel_free_all(& ssh);
#line 645
  return (0);
}
}
